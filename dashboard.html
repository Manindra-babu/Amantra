<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Amantra - Dashboard</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="dashboard.css">
  <link rel="stylesheet" href="calendar.css">
</head>

<body>

  <div class="shell">
    <header>
      <div class="logo">Amantra</div>

      <!-- Profile Wrapper -->
      <div class="profile-wrapper">
        <div class="notification-wrapper" style="position: relative;">
          <button class="header-icon-btn" id="btnNotifications" title="Notifications">
            <div class="dock-badge active" id="notifBadge"></div>
            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
          </button>

          <!-- Notification Dropdown -->
          <div class="notification-dropdown" id="notificationDropdown" style="right: -80px; width: 300px;">
            <div class="dropdown-header" style="padding:12px 16px; font-weight:600; color:#e2e8f0;">
              Notifications
            </div>
            <div id="dropdownNotifList">
              <!-- Populated via JS -->
            </div>
          </div>
        </div>

        <div class="header-profile" id="profileTrigger" title="My Profile">
          <img src="https://ui-avatars.com/api/?name=User&background=334155&color=cbd5e1" alt="Profile" />
        </div>

        <!-- Profile Dropdown Menu -->
        <div class="profile-dropdown" id="profileDropdown">
          <div class="dropdown-item" id="btnProfileDetails">
            <svg viewBox="0 0 24 24">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            Profile Details
          </div>
          <!-- Edit Profile Removed -->
          <div class="dropdown-item" id="btnAccountSettings">
            <svg viewBox="0 0 24 24">
              <path
                d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.74v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
              </path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
            Account Settings
          </div>
          <div class="dropdown-item" id="btnBilling">
            <svg viewBox="0 0 24 24">
              <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
              <line x1="1" y1="10" x2="23" y2="10"></line>
            </svg>
            Billing & Plans
          </div>
          <div class="dropdown-item" id="btnPrivacy">
            <svg viewBox="0 0 24 24">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
            </svg>
            Privacy & Security
          </div>
          <div class="dropdown-divider"></div>
          <div class="dropdown-item" id="btnShareProfile">
            <svg viewBox="0 0 24 24">
              <circle cx="18" cy="5" r="3"></circle>
              <circle cx="6" cy="12" r="3"></circle>
              <circle cx="18" cy="19" r="3"></circle>
              <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
              <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
            </svg>
            Share Profile
          </div>
          <div class="dropdown-item" id="btnEvents">
            <svg viewBox="0 0 24 24">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
            Events
          </div>
          <div class="dropdown-divider"></div>
          <div class="dropdown-item" id="btnHelp">
            <svg viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            Help & Support
          </div>
          <div class="dropdown-item danger" id="btnSignOut">
            <svg viewBox="0 0 24 24">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            Sign Out
          </div>
        </div>
      </div>
    </header>

    <div class="mode-toggle-wrapper">
      <div class="mode-toggle" id="modeToggle">
        <button type="button" id="btnCustomer" class="active">Customer</button>
        <button type="button" id="btnVender">Vender</button>
      </div>
    </div>

    <!-- SPLIT LAYOUT -->
    <div class="dashboard-split">
      <!-- LEFT: NAVIGATION -->
      <div class="nav-panel" id="navPanel">
        <!-- Rendered via JS -->
      </div>

      <!-- RIGHT: STAGE -->
      <div class="stage-panel">
        <div class="stage-content" id="stageContent">
          <!-- Rendered via JS -->
        </div>
      </div>
    </div>

  </div>

  <!-- BOTTOM DOCK (Static) -->
  <div class="bottom-dock">
    <button class="dock-btn" title="Pending Approvals" id="btnPending">
      <div class="dock-badge active" id="pendingBadge" style="display:none; background:#fb923c;"></div>
      <svg viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
      <span>Pending</span>
    </button>

    <div class="dock-divider"></div>

    <button class="dock-btn" title="Request Changes" id="btnRequestLog">
      <div class="dock-badge" id="requestBadge"></div>
      <svg viewBox="0 0 24 24">
        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
      </svg>
      <span>Request Log</span>
    </button>

    <div class="dock-divider"></div>

    <button class="dock-btn accent" title="New Deal" id="btnNewDeal">
      <svg viewBox="0 0 24 24">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
      <span>New Deal</span>
    </button>

    <div class="dock-divider"></div>

    <button class="dock-btn" title="History" id="btnHistory">
      <svg viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
      <span>History</span>
    </button>

    <div class="dock-divider"></div>

    <button class="dock-btn" title="Calendar" id="btnCalendar">
      <svg viewBox="0 0 24 24">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="16" y1="2" x2="16" y2="6"></line>
        <line x1="8" y1="2" x2="8" y2="6"></line>
        <line x1="3" y1="10" x2="21" y2="10"></line>
      </svg>
      <span>Calendar</span>
    </button>
  </div>

  <!-- SHARED MODAL OVERLAY -->
  <div class="slide-overlay" id="slideOverlay"></div>

  <!-- PANEL 1: PROFILE DETAILS -->
  <div class="slide-panel" id="profileSlidePanel">
    <div class="slide-header">
      <h2 class="slide-title" id="profilePanelTitle">Profile Details</h2>
      <div style="display: flex; align-items: center;">
        <button class="edit-toggle-btn" id="btnEnableEdit" onclick="enableProfileEdit()">Edit</button>
        <button class="slide-close" id="closeProfilePanel">✕</button>
      </div>
    </div>
    <div class="slide-body">
      <form id="profileForm" onsubmit="handleProfileSave(event)">
        <!-- User Summary -->
        <div class="profile-hero">
          <div class="profile-hero-img">
            <img src="https://ui-avatars.com/api/?name=User&background=334155&color=cbd5e1" alt="Profile" />
            <div class="edit-avatar-btn" id="avatarEditBtn" title="Change Photo" style="display: none;">
              <svg viewBox="0 0 24 24">
                <path d="M12 20h9"></path>
                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
              </svg>
            </div>
          </div>
          <div class="profile-hero-name" id="heroNameDisplay">Aditya Sharma</div>
          <div class="profile-hero-role">Premium Investor</div>
        </div>

        <!-- Personal Information -->
        <div class="detail-section">
          <h4>Personal Information</h4>
          <div class="form-group">
            <label>Full Name</label>
            <input type="text" id="profileName" class="glass-input" value="Aditya Sharma" disabled required />
          </div>
          <div class="form-group">
            <label>Email Address</label>
            <input type="email" id="profileEmail" class="glass-input" value="aditya.sharma@example.com" disabled
              required />
          </div>
          <div class="form-group">
            <label>Phone Number</label>
            <input type="tel" id="profilePhone" class="glass-input" value="+91 98765 43210" disabled required />
          </div>
        </div>

        <!-- Registered Address -->
        <div class="detail-section">
          <h4>Registered Address</h4>
          <div class="form-group">
            <label>Street / Apartment</label>
            <input type="text" id="profileStreet" class="glass-input" value="12/4 Park Avenue, Koramangala" disabled
              required />
          </div>
          <div class="form-group">
            <label>City</label>
            <input type="text" id="profileCity" class="glass-input" value="Bangalore, KA" disabled required />
          </div>
          <div class="form-group">
            <label>Postal Code</label>
            <input type="text" id="profileZip" class="glass-input" value="560034" disabled required />
          </div>
        </div>

        <!-- System Info (Read Only) -->
        <div class="detail-section">
          <h4>Account Status (Read Only)</h4>
          <div class="form-group">
            <label>KYC Status</label>
            <input type="text" id="profileKYC" class="glass-input" value="Verified" disabled />
          </div>
          <div class="form-group">
            <label>Member ID</label>
            <input type="text" id="profileMemberID" class="glass-input" value="AM-883920" disabled />
          </div>
        </div>

        <button type="submit" id="saveProfileBtn" class="save-btn" style="display: none;">Save Changes</button>
      </form>
    </div>
  </div>

  <!-- PANEL 2: NEW DEAL (OFFICIAL CONTRACT THEME) -->
  <div class="slide-panel" id="newDealSlidePanel">
    <div class="slide-header">
      <h2 class="slide-title">Draft New Contract</h2>
      <button class="slide-close" id="closeNewDealPanel">✕</button>
    </div>
    <div class="slide-body">

      <!-- State 1: Form -->
      <div id="contractFormContainer">
        <form id="newDealForm" onsubmit="handleContractSubmit(event)">
          <div class="detail-section">
            <h4>Contract Details</h4>
            <div class="form-group">
              <label>Deal / Contract Title</label>
              <input type="text" id="dealTitleInput" class="glass-input" placeholder="e.g. Service Agreement Q3"
                required />
            </div>
            <div class="form-row">
              <div class="form-group">
                <label id="lblCounterparty">Counterparty (Email/ID)</label>
                <input type="text" id="dealCounterparty" class="glass-input" placeholder="vendor@example.com"
                  required />
              </div>
              <div class="form-group">
                <label>Counterparty Name</label>
                <input type="text" id="dealCounterpartyName" class="glass-input" placeholder="e.g. John Doe, Tech Corp"
                  required />
              </div>
              <div class="form-group">
                <label>Contract Type</label>
                <select id="contractType" class="glass-select">
                  <option value="Service Agreement">Service Agreement</option>
                  <option value="Non-Disclosure (NDA)">Non-Disclosure (NDA)</option>
                  <option value="Employment Contract">Employment Contract</option>
                  <option value="Sales of Goods">Sales of Goods</option>
                  <option value="Loan / Bond">Loan / Bond</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Dynamic Fields Container -->
          <div id="dynamicFields"></div>

          <div id="financeSection" class="detail-section">
            <h4>Financial Details</h4>
            <div class="form-row">
              <div class="form-group">
                <label>Total Value (₹)</label>
                <input type="number" class="glass-input" placeholder="50000" />
              </div>
              <div class="form-group">
                <label>Payment Terms</label>
                <select class="glass-select">
                  <option>Net 30 Days</option>
                  <option>Upon Receipt</option>
                  <option>Milestone Based</option>
                  <option>50% Advance</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Effective Date</label>
                <input type="date" id="effectiveDate" class="glass-input" required />
              </div>
              <div class="form-group">
                <label>Termination / Maturity</label>
                <input type="date" class="glass-input" />
              </div>
            </div>
          </div>

          <div class="detail-section">
            <h4>Terms & Conditions</h4>
            <div class="form-group">
              <label>Specific Clauses</label>
              <textarea id="termsInput" class="glass-textarea"
                placeholder="Enter contract specific terms here..."></textarea>
            </div>
          </div>

          <button type="submit" class="save-btn">Send Proposal</button>
          <div class="contract-footer">Confidential & Proprietary • Amantra Contract Generation System</div>
        </form>
      </div>

      <!-- State 2: Success & Share -->
      <div id="contractSuccessContainer" style="display: none;">
        <div class="success-icon-wrapper">
          <div class="success-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"
              stroke-linecap="round" stroke-linejoin="round">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          </div>
        </div>
        <div class="success-msg">
          <h3>Contract Drafted</h3>
          <p>Your contract has been generated successfully.</p>
        </div>

        <!-- Official Paper Preview -->
        <div class="paper-preview">
          <div class="preview-title" id="previewTitle">Contract Title</div>
          <div class="preview-row">
            <span class="preview-label" id="lblPreviewSender">Between (Customer):</span>
            <span class="preview-val" id="previewSender">Aditya Sharma</span>
          </div>
          <div class="preview-row">
            <span class="preview-label" id="lblPreviewCounterparty">And (Vender):</span>
            <span class="preview-val" id="previewCounterparty">Counterparty</span>
          </div>
          <div class="preview-row">
            <span class="preview-label">Effective Date:</span>
            <span class="preview-val" id="previewDate">2025-01-01</span>
          </div>
          <div style="margin-top: 12px; font-size: 0.75rem; color: #334155; line-height: 1.4;">
            This agreement is entered into by and between the parties listed above, hereinafter referred to as "First
            Party" and "Second Party". The parties agree to the terms set forth... (Preview content)
          </div>
        </div>

        <div class="detail-section">
          <h4>Share Contract</h4>
          <div class="share-grid">

            <button class="share-btn whatsapp"
              onclick="window.open('https://wa.me/?text=Here is the contract link: https://amantra.com/c/12345')">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z" />
              </svg>
              WhatsApp
            </button>
            <button class="share-btn email" onclick="sendContractEmail()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                <polyline points="22,6 12,13 2,6"></polyline>
              </svg>
              Email
            </button>
            <button class="share-btn" onclick="downloadContractPDF()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              Download PDF
            </button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- PANEL 3: CALENDAR (NEW) -->
  <div class="slide-panel" id="calendarSlidePanel">
    <div class="slide-header">
      <span class="slide-title">Calendar</span>
      <button class="slide-close" id="closeCalendarPanel">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="slide-content">
      <!-- New Calendar Structure -->
      <div class="calendar-wrapper">
        <div class="calendar-header">
          <button class="calendar-nav-btn" id="prevMonthBtn">&lt;</button>
          <div class="calendar-month-title" id="calendarMonthTitle">December 2025</div>
          <button class="calendar-nav-btn" id="nextMonthBtn">&gt;</button>
        </div>

        <div class="calendar-grid">
          <!-- Day Names -->
          <div class="calendar-day-name">Sun</div>
          <div class="calendar-day-name">Mon</div>
          <div class="calendar-day-name">Tue</div>
          <div class="calendar-day-name">Wed</div>
          <div class="calendar-day-name">Thu</div>
          <div class="calendar-day-name">Fri</div>
          <div class="calendar-day-name">Sat</div>

          <!-- Dates will be injected here via JS -->
          <div id="calendarDatesGrid" style="display:contents;"></div>
        </div>

        <div class="calendar-events-container">
          <h5 style="margin-bottom:10px; color:#64748b; font-size:0.8rem; text-transform:uppercase;">Events for <span
              id="selectedDateDisplay">Dec 24</span></h5>
          <div id="calendarEventsList">
            <!-- Events injected here -->
          </div>
        </div>
      </div>
    </div>
  </div>

  </div>
  </div>

  <!-- PANEL 4: VIEW CONTRACT (FOR INCOMING REQUESTS) -->
  <div class="slide-panel" id="viewContractPanel">
    <div class="slide-header">
      <h2 class="slide-title">Contract Details</h2>
      <button class="slide-close" id="closeViewContractPanel">✕</button>
    </div>
    <div class="slide-body">

      <!-- State 1: Review -->
      <div id="reviewState">
        <div class="paper-preview">
          <div class="preview-title" id="viewContractTitle">Service Level Agreement</div>

          <div class="preview-row">
            <span class="preview-label">Between:</span>
            <span class="preview-val" id="viewParty1">Aditya Sharma (Customer)</span>
          </div>
          <div class="preview-row">
            <span class="preview-label">And:</span>
            <span class="preview-val" id="viewParty2">TechCorp Solutions (Vender)</span>
          </div>

          <div
            style="margin-top: 15px; margin-bottom: 5px; font-weight: 700; text-transform: uppercase; font-size: 0.8rem; color: #000;">
            Terms & Conditions
          </div>
          <div id="viewContractBody"
            style="font-size: 0.8rem; color: #334155; line-height: 1.5; white-space: pre-line;">
            1. Scope of Work: The Vender agrees to provide maintenance services for the specified software
            suite.<br><br>
            2. Payment: A monthly retainer of ₹15,000 shall be paid by the 5th of each month.<br><br>
            3. Termination: Either party may terminate this agreement with 30 days written notice.
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="contract-actions-footer">
          <button class="btn-action accept" onclick="acceptContract()">Accept Deal</button>
          <button class="btn-action change" onclick="openChangeRequest()">Request Change</button>
        </div>
      </div>

      <!-- State 2: Request Change (New Form) -->
      <div id="requestChangeState" style="display: none;">
        <div class="detail-section">
          <h4>Request Revisions</h4>
          <p style="font-size: 0.85rem; color: #64748b; margin-bottom: 20px; line-height: 1.5;">
            Please detail the clauses, terms, or financials you wish to modify. This request will be sent to the
            counterparty for review.
          </p>
          <div class="form-group">
            <label>Requested Changes</label>
            <textarea id="changeRequestInput" class="glass-textarea"
              placeholder="e.g. Update payment terms to Net 45 days; Revise scope of liability..."
              style="min-height: 180px;"></textarea>
          </div>
        </div>

        <div class="contract-actions-footer">
          <button class="btn-action accept" style="background: #0f172a;" onclick="submitChangeRequest()">Send
            Request</button>
          <button class="btn-action change" style="background: transparent; color: #64748b; border: 1px solid #cbd5e1;"
            onclick="cancelChangeRequest()">Cancel</button>
        </div>
      </div>

      <!-- State 4: Change Request Success (Ticket) -->
      <div id="requestSuccessState" style="display: none;">
        <div class="success-icon-wrapper">
          <div class="success-icon" style="background: #fffbeb; color: #b45309;">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"
              stroke-linecap="round" stroke-linejoin="round">
              <line x1="22" y1="2" x2="11" y2="13"></line>
              <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
            </svg>
          </div>
        </div>
        <div class="success-msg">
          <h3>Request Submitted</h3>
          <p>Your revision request has been queued.</p>
        </div>

        <div class="ticket-view">
          <div class="ticket-id" id="ticketIdDisplay">REQ-2025-8832</div>
          <div class="ticket-status">Pending Review</div>
          <div style="font-size: 0.9rem; color: #0f172a; margin-bottom: 8px;">Changes for: <strong
              id="ticketContractTitle">Contract Title</strong></div>
          <div id="ticketContentDisplay"
            style="text-align: left; font-size: 0.8rem; color: #475569; line-height: 1.5; background: #f8fafc; padding: 10px; border-radius: 4px;">
            -- Content --
          </div>
        </div>

        <div class="detail-section">
          <h4>Options</h4>
          <div class="share-grid">
            <button class="share-btn" onclick="openPanel(requestLogPanel)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <list></list>
                <path d="M8 6h13"></path>
                <path d="M8 12h13"></path>
                <path d="M8 18h13"></path>
                <path d="M3 6h.01"></path>
                <path d="M3 12h.01"></path>
                <path d="M3 18h.01"></path>
              </svg>
              Track Status
            </button>
            <button class="share-btn" onclick="openChangeRequest()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
              </svg>
              Edit
            </button>
          </div>
          <button class="btn-action change"
            style="margin-top: 10px; width: 100%; background: transparent; border: 1px solid #ef4444; color: #ef4444;"
            onclick="cancelChangeRequest()">Withdraw Request</button>
        </div>
      </div>

      <!-- State 3: Accepted (Official Paper) -->
      <div id="acceptedState" style="display: none;">
        <div class="success-icon-wrapper">
          <div class="success-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
          </div>
        </div>
        <div class="success-msg">
          <h3>Agreement Finalized</h3>
          <p>The contract has been legally executed.</p>
        </div>

        <div class="paper-preview">
          <!-- Official Stamp Overlay -->
          <div class="official-stamp">
            Accepted
            <span>Verified</span>
          </div>

          <div class="preview-title">Official Agreement</div>

          <div class="agreement-meta">
            <div class="preview-row">
              <span class="preview-label">Agreement ID:</span>
              <span class="preview-val" id="officialAgmtId">#AGT-0000</span>
            </div>
            <div class="preview-row">
              <span class="preview-label">Timestamp:</span>
              <span class="preview-val" id="officialTimestamp">--</span>
            </div>
          </div>

          <div style="font-size: 0.8rem; color: #000; line-height: 1.5;">
            This document certifies that the contract titled <strong id="officialTitle">--</strong> has been formally
            accepted by all parties.
            <br><br>
            <strong>Party A:</strong> <span id="officialP1">--</span><br>
            <strong>Party B:</strong> <span id="officialP2">--</span>
            <br><br>
            This digital record serves as binding proof of the agreement.
          </div>
        </div>

        <div class="detail-section">
          <h4>Actions</h4>
          <div class="share-grid">
            <button class="share-btn" onclick="downloadContractPDF()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              Download PDF
            </button>
            <button class="share-btn email" onclick="sendContractEmail()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                <polyline points="22,6 12,13 2,6"></polyline>
              </svg>
              Email Copy
            </button>

          </div>
        </div>

      </div>

    </div>
  </div>

  <!-- PANEL 5: REQUEST LOG -->
  <div class="slide-panel" id="requestLogPanel">
    <div class="slide-header">
      <h2 class="slide-title">Change Requests Log</h2>
      <button class="slide-close" id="closeRequestLogPanel">✕</button>
    </div>
    <div class="slide-body">
      <div id="requestLogContainer">
        <div class="no-events">No active requests found.</div>
      </div>
    </div>
  </div>

  <!-- PANEL 6: PENDING APPROVALS (New Panel) -->
  <div class="slide-panel" id="pendingSlidePanel">
    <div class="slide-header">
      <h2 class="slide-title">Pending Approvals</h2>
      <button class="slide-close" id="closePendingPanel">✕</button>
    </div>
    <div class="slide-body">
      <div id="pendingListContainer">
        <!-- Populated via JS -->
      </div>
    </div>
  </div>

  <!-- PANEL 7: HISTORY (NEW) -->
  <div class="slide-panel" id="historySlidePanel">
    <div class="slide-header">
      <h2 class="slide-title">Past Deals</h2>
      <button class="slide-close" id="closeHistoryPanel">✕</button>
    </div>
    <div class="slide-body">
      <div id="historyList">
        <!-- Populated via JS -->
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script type="module" src="dashboard.js"></script>
</body>

</html>